webpackJsonp([46],{gvzG:function(t,e){},qWDM:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("mvHQ"),a=s.n(i),n=s("woOf"),o=s.n(n),l=(s("cnGM"),s("S6j6")),r=s.n(l),c=(s("2lDz"),s("t42S")),u=s.n(c),h=(s("79O3"),s("fpgn")),m=s.n(h),d=(s("jydU"),s("WQwN")),g=s.n(d),p=(s("QP/A"),s("pyxX")),v=s.n(p),f=(s("GKy3"),s("4vvA")),_=s.n(f),S=(s("tLo2"),s("blRl")),w=s.n(S),D=(s("D0HL"),s("tLiD")),y=s.n(D),I=(s("MHRi"),s("6xqC")),k=s.n(I),b=(s("FDxC"),s("w+oK")),x=s.n(b),F=(s("wvM5"),s("MyDk")),L=s.n(F),C=(s("dL9u"),s("L00R")),P=s.n(C),B=(s("Rv11"),s("TMdk")),V=s.n(B),M=s("Cz8s"),H=s("VsUZ"),q=s("7+uW");q.default.use(V.a),q.default.use(P.a),q.default.use(L.a),q.default.use(x.a),q.default.use(k.a),q.default.use(u.a).use(m.a).use(g.a).use(v.a).use(_.a).use(w.a).use(y.a),q.default.use(r.a);var N={components:{vantHeader:M.default},data:function(){return{questionText:"提交问题",examRecord:[],examRecordTime:[],StaffInfoData:[],fileList:[],fileListImg:"http://192.168.0.189:8282/72ede5a4-5e0d-4d3f-90ea-a343c27eb2af",IDCard:"",message:"",columns:["安全问题","质量问题","进度问题"],value:"",showPicker:!1,columnsS:["特别紧急","紧急","一般"],valueS:"",showPickerS:!1,minHour:10,maxHour:20,minDate:new Date((new Date).getFullYear(),(new Date).getMonth(),(new Date).getDate(),(new Date).getHours(),(new Date).getMinutes()),maxDate:new Date((new Date).getFullYear()+5,(new Date).getMonth(),(new Date).getDate(),(new Date).getHours(),(new Date).getMinutes()),currentDateStart:new Date,showStart:!1,timeValueStart:"",currentDate:new Date,show:!1,timeValue:"",getHour_s:"",getMinutes_s:"",day_s:"",month_s:"",location:"",messageQuesc:"",longitude:0,latitude:0,curPositionStatus:!1,isFirstPosition:!1,geolocation:"",options:{timeout:8e3,failTipFlag:!0},addr:"",city:"",longlat:!1,peleList:"",quesType:"",degreeid:"",user:{userName:"",BID:"",userid:""},fileSrc:"",principal:{},price:!1,positiondata:{}}},mounted:function(){},created:function(){var t=this;H.getW("/api/safety/selectUserById?id="+this.$route.query.userId).then(function(e){200==e.status&&200==e.data.code&&(t.user.userName=e.data.data.info.USERNAME,t.user.BID=e.data.data.info.BID,t.user.userid=e.data.data.info.USERID)});var e=sessionStorage.getItem("principal");if(!e)return sessionStorage.setItem("principal",null),null==sessionStorage.getItem("principal")?void(this.price=!1):void 0;this.price=!0,o()(this.principal,JSON.parse(e)),this.peleList=this.principal.username,this.value=sessionStorage.getItem("value"),this.valueS=sessionStorage.getItem("valueS"),this.timeValueStart=sessionStorage.getItem("timeValueStart"),this.timeValue=sessionStorage.getItem("timeValue");var s=sessionStorage.getItem("position");if(!s)return sessionStorage.setItem("position",null),null==sessionStorage.getItem("position")?void(this.longlat=!1):void 0;this.longlat=!0,o()(this.positiondata,JSON.parse(s)),this.latitude=this.positiondata.latitude,this.longitude=this.positiondata.longitude,this.city=this.positiondata.city,this.addr=this.positiondata.addr,this.messageQuesc=sessionStorage.getItem("messageQuesc"),this.message=sessionStorage.getItem("message"),this.fileList=sessionStorage.getItem("fileListS")},methods:{IntelligenceButton:function(){sessionStorage.setItem("messageQuesc",this.messageQuesc),sessionStorage.setItem("message",this.message),this.$router.push({path:"/IntelligenceHead?userId="+this.$route.query.userId})},deleteButton:function(){},fileListImgButton:function(t){var e=t.target.files,s=void 0,i=void 0;for(var a in console.log(e),e){if(s=e[a].name.split(".")[1].toLowerCase(),i=window.URL.createObjectURL(e[a]),console.log("====",i),!s.match(/png|jpg|jpeg/))return void alert("上传错误,文件格式必须为：png/jpg/jpeg");var n=document.getElementById("previewImg"),o=document.createElement("img");o.width=200,o.height=200,o.src=i,n.appendChild(o),this.fileListImg}},afterRead:function(t){new FileReader;console.log("this.fileList",this.fileList)},longlatButton:function(){var t=this;k.a.confirm({title:"标题",message:"应用将获取您的位置信息？","show-confirm-button":!0}).then(function(){t.longlat=!0,t.getMyLocation(!1)}).catch(function(){t.longlat=!1})},longlatButtonD:function(){var t=this;k.a.confirm({title:"标题",message:"应用将获取您的位置信息？","show-confirm-button":!0}).then(function(){t.longlat=!0,t.getMyLocation(!1)}).catch(function(){t.longlat=!0})},clearButton:function(){console.log(this.longlat),this.longlat=!1,this.latitude="",this.longitude="",this.city="",this.addr=""},sumtrienButton:function(){""!=this.value?""!=this.valueS?""!=this.timeValueStart?""!=this.timeValue?""!=this.city?""!=this.messageQuesc?""!=this.message?""!=this.fileList?""!=this.peleList?""!=this.timeValueStart&&""!=this.value&&""!=this.timeValue&&""!=this.peleList&&""!=this.valueS&&""!=this.fileList&&""!=this.message&&""!=this.messageQuesc&&""!=this.city&&(console.log("putNameId",this.user.userid,"putName",this.user.userName,"quesType",this.quesType,"degreeid",this.degreeid,"dates",this.timeValueStart,"quesDesc",this.messageQuesc,"quesDetail",this.message,"quesPic",a()(this.fileListImg),"endDate",this.timeValue,"principle",this.principal.userid,"departmentid",this.user.BID,"principleName",this.peleList),H.postParamsW("/api/safety/saveSafety",{putNameId:this.user.userid,putName:this.user.userName,quesType:this.quesType,degreeid:this.degreeid,dates:this.timeValueStart,quesDesc:this.messageQuesc,quesDetail:this.message,quesPic:this.fileListImg,endDate:this.timeValue,principle:this.principal.userid,departmentid:this.user.BID,principleName:this.peleList}).then(function(t){console.log("selectSafetyInfoById",t)})):_()("请选择负责人"):_()("请上传照片"):_()("请简述您的问题详情"):_()("请简述您的问题"):_()("请获取您当前位置"):_()("请选择限定时间"):_()("请选择开始时间"):_()("请选择紧急类型"):_()("请选择问题类型")},getMyLocation:function(t){this.curPositionStatus=t,this.geolocation=new qq.maps.Geolocation("5TZBZ-MEZCW-KKJR3-RPIHK-AGSAK-HHFSH","myapp"),this.geolocation.getLocation(this.showPosition,this.showErr,this.options)},showPosition:function(t){this.latitude=t.lat,this.longitude=t.lng,this.city=t.city,this.addr=t.addr,sessionStorage.setItem("position",a()({latitude:this.latitude,longitude:this.longitude,city:t.city,addr:t.addr}))},showErr:function(){if(!this.isFirstPosition)return this.geolocation.getIpLocation(this.showPosition,this.showErr),void(this.isFirstPosition=!0);_()("定位失败")},confirmFnStart:function(){this.timeValueStart=this.timeFormatStart(this.currentDateStart),this.showStart=!1,sessionStorage.setItem("timeValueStart",this.timeValueStart)},cancelFnStart:function(){this.showStart=!1},showTimePopStart:function(){this.showStart=!0,this.currentDateStart=new Date(this.timeValueStart.replace(/-/g,"/"))},timeFormatStart:function(t){var e=t.getFullYear(),s=t.getMonth()+1,i=t.getDate(),a=t.getHours(),n=t.getMinutes();(new Date).getHours();return a<10&&(this.getHour_s="0"+a),(a>10||10===a)&&(this.getHour_s=a),n<10&&(this.getMinutes_s="0"+n),(n>10||10===n)&&(this.getMinutes_s=n),s<10&&(this.month_s="0"+s),s>10&&(this.month_s=s),10===s&&(this.month_s=s),i<10&&(this.day_s="0"+i),i>10&&(this.day_s=i),10===i&&(this.day_s=i),e+"-"+this.month_s+"-"+this.day_s+" "+this.getHour_s+":"+this.getMinutes_s},confirmFn:function(){this.timeValue=this.timeFormat(this.currentDate),this.show=!1,sessionStorage.setItem("timeValue",this.timeValue)},cancelFn:function(){this.show=!1},showTimePop:function(){this.show=!0,this.currentDate=new Date(this.timeValue.replace(/-/g,"/"))},timeFormat:function(t){var e=t.getFullYear(),s=t.getMonth()+1,i=t.getDate(),a=t.getHours(),n=t.getMinutes();(new Date).getHours();return a<10&&(this.getHour_s="0"+a),(a>10||10===a)&&(this.getHour_s=a),n<10&&(this.getMinutes_s="0"+n),(n>10||10===n)&&(this.getMinutes_s=n),s<10&&(this.month_s="0"+s),s>10&&(this.month_s=s),10===s&&(this.month_s=s),i<10&&(this.day_s="0"+i),i>10&&(this.day_s=i),10===i&&(this.day_s=i),e+"-"+this.month_s+"-"+this.day_s+" "+this.getHour_s+":"+this.getMinutes_s},onConfirm:function(t,e){this.value=t,this.showPicker=!1,this.quesType=e+Number(1),console.log("---quesType--",this.quesType),sessionStorage.setItem("value",this.value)},onConfirmS:function(t,e){this.valueS=t,this.showPickerS=!1,this.degreeid=e+Number(1),sessionStorage.setItem("valueS",this.valueS),console.log("--degreeid---",this.degreeid)},StaffInfoF:function(){}}},T={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"examrecord"}},[s("vant-header",{attrs:{leftArrow:!0,titleType:1,title:t.questionText,rightType:2}}),t._v(" "),s("div",{staticClass:"container"},[s("h5",[t._v("问题情况")]),t._v(" "),s("ul",{staticClass:"container_list"},[s("li",{staticClass:"list_li"},[s("van-cell",{attrs:{"is-link":""},on:{click:function(e){t.showPicker=!0}}},[s("span",[t._v("问题类型")]),t._v(" "),s("span",[t._v(t._s(t.value?t.value:"请选择"))])]),t._v(" "),s("van-popup",{attrs:{position:"bottom"},model:{value:t.showPicker,callback:function(e){t.showPicker=e},expression:"showPicker"}},[s("van-picker",{attrs:{"show-toolbar":"",columns:t.columns},on:{cancel:function(e){t.showPicker=!1},confirm:t.onConfirm}})],1)],1),t._v(" "),s("li",{staticClass:"list_li"},[s("van-cell",{attrs:{"is-link":""},on:{click:function(e){t.showPickerS=!0}}},[s("span",[t._v("紧急类型")]),t._v(" "),s("span",[t._v(t._s(t.valueS?t.valueS:"请选择"))])]),t._v(" "),s("van-popup",{attrs:{position:"bottom"},model:{value:t.showPickerS,callback:function(e){t.showPickerS=e},expression:"showPickerS"}},[s("van-picker",{attrs:{"show-toolbar":"",columns:t.columnsS},on:{cancel:function(e){t.showPickerS=!1},confirm:t.onConfirmS}})],1)],1),t._v(" "),s("li",{staticClass:"list_li"},[s("van-cell",{attrs:{"is-link":""},on:{click:t.showTimePopStart}},[s("span",[t._v("提问时间")]),t._v(" "),s("span",[t._v(t._s(t.timeValueStart?t.timeValueStart:"请选择"))])]),t._v(" "),s("van-popup",{attrs:{position:"bottom"},model:{value:t.showStart,callback:function(e){t.showStart=e},expression:"showStart"}},[s("van-datetime-picker",{staticClass:"order-time-pop",attrs:{type:"datetime","min-date":t.minDate,"max-date":t.maxDate},on:{confirm:function(e){return t.confirmFnStart()},cancel:function(e){return t.cancelFnStart()}},model:{value:t.currentDateStart,callback:function(e){t.currentDateStart=e},expression:"currentDateStart"}})],1)],1),t._v(" "),s("li",{staticClass:"list_li"},[s("van-cell",{attrs:{"is-link":""},on:{click:t.showTimePop}},[s("span",[t._v("限定时间")]),t._v(" "),s("span",[t._v(t._s(t.timeValue?t.timeValue:"请选择"))])]),t._v(" "),s("van-popup",{attrs:{position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("van-datetime-picker",{staticClass:"order-time-pop",attrs:{type:"datetime","min-date":t.minDate,"max-date":t.maxDate},on:{confirm:function(e){return t.confirmFn()},cancel:function(e){return t.cancelFn()}},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1)],1)]),t._v(" "),s("h5",[t._v("问题地点")]),t._v(" "),s("ul",{staticClass:"container_list"},[s("li",{directives:[{name:"show",rawName:"v-show",value:t.longlat,expression:"longlat"}],staticClass:"more",staticStyle:{padding:"10px 16px"}},[s("div",{staticStyle:{border:"1px dashed #E6EDF7"}},[s("van-cell",{staticStyle:{color:"#304F83",background:"#F7FAFF"}},[s("span",{staticStyle:{"margin-top":"2px",display:"block",float:"left"}},[s("van-icon",{attrs:{name:"location-o",color:"#304F83"}})],1),t._v(t._s(t.city)+t._s(t.addr)+"\n\t\t\t\t\t")]),t._v(" "),s("van-cell",{staticStyle:{"font-size":"12px",background:"#F7FAFF",color:"rgba(152,160,174,1)","border-bottom":"none"}},[t._v("\n\t\t\t\t\t\t经度："+t._s(t.latitude)+" 纬度："+t._s(t.longitude)+"\n\t\t\t\t\t")])],1)]),t._v(" "),s("li",{staticClass:"Buttond"},[s("van-button",{directives:[{name:"show",rawName:"v-show",value:!t.longlat,expression:"!longlat"}],staticStyle:{width:"100%"},attrs:{color:"rgba(89,95,115,1) ",icon:"location-o",size:"normal"},on:{click:function(e){return t.longlatButton()}}},[t._v("获取当前位置")])],1),t._v(" "),s("li",{directives:[{name:"show",rawName:"v-show",value:t.longlat,expression:"longlat"}],staticClass:"Buttond"},[s("van-button",{staticStyle:{float:"left",width:"48%"},attrs:{color:"#DDDDDD ",size:"normal"},on:{click:function(e){return t.clearButton()}}},[s("span",{staticStyle:{color:"#666"}},[t._v("清空地址")])]),t._v(" "),s("van-button",{staticStyle:{float:"right",width:"48%"},attrs:{color:"rgba(89,95,115,1) ",size:"normal"},on:{click:function(e){return t.longlatButtonD()}}},[t._v("重新定位")])],1)]),t._v(" "),s("h5",[t._v("问题简述")]),t._v(" "),s("div",{staticClass:"container_list"},[s("van-cell-group",[s("van-field",{attrs:{rows:"2",autosize:"",type:"textarea",maxlength:"300",placeholder:"请检单描述您的问题,方便及时跟进并解决。","show-word-limit":""},model:{value:t.messageQuesc,callback:function(e){t.messageQuesc=e},expression:"messageQuesc"}})],1)],1),t._v(" "),s("h5",[t._v("问题详情")]),t._v(" "),s("div",{staticClass:"container_list"},[s("van-cell-group",[s("van-field",{attrs:{rows:"2",autosize:"",type:"textarea",maxlength:"300",placeholder:"请检单描述您的问题,方便及时跟进并解决。","show-word-limit":""},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1)],1),t._v(" "),s("ul",{staticClass:"container_list container_listp"},[t._m(0),t._v(" "),s("li",{staticClass:"overflow"},[s("van-uploader",{attrs:{"after-read":t.afterRead,multiple:"","max-count":4,delete:t.deleteButton()},model:{value:t.fileList,callback:function(e){t.fileList=e},expression:"fileList"}})],1)]),t._v(" "),s("h5",[t._v("现成负责人")]),t._v(" "),s("ul",{staticClass:"container_list"},[t.price?s("li",{staticClass:"more",staticStyle:{padding:"10px 16px"}},[s("div",{staticStyle:{border:"1px dashed #E6EDF7"}},[s("van-cell",{staticStyle:{color:"#304F83",background:"#F7FAFF"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.peleList,expression:"peleList"}],staticStyle:{display:"none"},attrs:{type:"text"},domProps:{value:t.peleList},on:{input:function(e){e.target.composing||(t.peleList=e.target.value)}}}),t._v(" "),s("span",{staticStyle:{"margin-top":"2px",display:"block",float:"left"}},[s("van-icon",{attrs:{name:"manager",color:"#304F83"}})],1),t._v(t._s(t.principal.username)+"（CYCZQ-5标-1负责人）\n\t\t\t\t\t")])],1)]):t._e(),t._v(" "),s("li",{staticClass:"Buttond"},[t.price?t._e():s("van-button",{staticStyle:{width:"100%"},attrs:{color:"rgba(89,95,115,1) ",icon:"friends-o",size:"normal"},on:{click:function(e){return t.IntelligenceButton()}}},[t._v("点击选择人员")])],1),t._v(" "),s("li",{staticClass:"Buttond"},[t.price?s("van-button",{staticStyle:{width:"100%"},attrs:{color:"rgba(89,95,115,1) ",icon:"friends-o",size:"normal"},on:{click:function(e){return t.IntelligenceButton()}}},[t._v("重新选择人员")]):t._e()],1)]),t._v(" "),s("ul",[s("li",{staticClass:"Buttond"},[s("van-button",{staticStyle:{float:"left",width:"48%"},attrs:{color:"#DDDDDD ",size:"normal"}},[s("span",{staticStyle:{color:"#666"}},[t._v("暂存")])]),t._v(" "),s("van-button",{staticStyle:{float:"right",width:"48%"},attrs:{color:"#7099D0 ",size:"normal"},on:{click:function(e){return t.sumtrienButton()}}},[t._v("提交")])],1)])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"van-hairline--bottom exam-title"},[e("img",{attrs:{src:s("YqCx"),alt:""}}),this._v("上传照片 (最多4张)")])}]};var Q=s("VU/8")(N,T,!1,function(t){s("gvzG")},"data-v-7000495c",null);e.default=Q.exports}});
//# sourceMappingURL=46.5067123a98f4560e31a9.js.map